<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Cost Comparison Chart</title>
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/recharts@2.1.9/umd/Recharts.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const { BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } = Recharts;

      const CostComparisonChart = () => {
        const data = [
          {
            name: 'Previous VMC',
            'VMC Cluster': 470000,
            'Network Charges': 12600,
            'Supplemental AWS Environment': 496800,
            total: 979400,
          },
          {
            name: 'Renewed VMC',
            'VMC Cluster': 916760,
            'Network Charges': 12600,
            'Supplemental AWS Environment': 496800,
            total: 1426160,
          },
          {
            name: 'Current AWS',
            'AWS Native Cost': 1296498,
            total: 1296498,
          },
          {
            name: 'Optimized AWS',
            'AWS Native Cost': 1027056,
            total: 1027056,
          },
        ];

        const formatCurrency = (value) => {
          return `$${value.toLocaleString()}`;
        };

        const CustomTooltip = ({ active, payload, label }) => {
          if (active && payload && payload.length > 0) {
            const totalValue = payload.reduce((sum, entry) => sum + (entry.value || 0), 0);
            
            return (
              <div className="bg-white p-4 border border-gray-200 shadow-lg">
                <p className="font-bold mb-2">{label}</p>
                {payload.map((entry, index) => (
                  <p key={index} style={{ color: entry.color }}>
                    {entry.name}: {formatCurrency(entry.value)}
                  </p>
                ))}
                <p className="font-bold mt-2 border-t pt-2">
                  Total: {formatCurrency(totalValue)}
                </p>
              </div>
            );
          }
          return null;
        };

        return (
          <div className="w-full h-96 p-4">
            <ResponsiveContainer width="100%" height="100%">
              <BarChart
                data={data}
                margin={{
                  top: 20,
                  right: 30,
                  left: 20,
                  bottom: 5,
                }}
              >
                <CartesianGrid strokeDasharray="3 3" />
                <XAxis dataKey="name" />
                <YAxis tickFormatter={formatCurrency} />
                <Tooltip content={({ active, payload, label }) => (
                  <CustomTooltip active={active} payload={payload} label={label} />
                )} />
                <Legend />
                <Bar dataKey="VMC Cluster" fill="#8884d8" stackId="a" />
                <Bar dataKey="Network Charges" fill="#82ca9d" stackId="a" />
                <Bar dataKey="Supplemental AWS Environment" fill="#ffc658" stackId="a" />
                <Bar dataKey="AWS Native Cost" fill="#ff7300" stackId="a" />
              </BarChart>
            </ResponsiveContainer>
          </div>
        );
      };

      ReactDOM.render(
        <React.StrictMode>
          <div className="container mx-auto px-4">
            <h1 className="text-2xl font-bold text-center my-6">Cost Comparison Analysis</h1>
            <CostComparisonChart />
          </div>
        </React.StrictMode>,
        document.getElementById('root')
      );
    </script>
  </body>
</html>
